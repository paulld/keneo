<?phpsession_start();include("appel_db.php");if (isset($_SESSION['mot_de_passe']) AND $_SESSION['mot_de_passe'] == $_SESSION['pass']){	include("headersom.php");		//Mise à jour Infos	if (isset($_POST['Suppr']))	{		$supprid = $_POST['Suppr'];		//Actualisation deadline		$req = "DELETE FROM rob_menu_rights WHERE ID = ".$supprid;		$bdd->query($req);	}	if (isset($_POST['Add']))	{		$curr_menu_id = $_POST['curr_menu_id'];		$curr_ssmenu_id = $_POST['curr_ssmenu_id'];		$curr_level_id = $_POST['curr_level_id'];		//Actualisation deadline		$req = "INSERT INTO rob_menu_rights VALUES ('', '$curr_menu_id', '$curr_ssmenu_id', '$curr_level_id')";		$bdd->query($req);	}	// ====================== MISE A JOUR ======================	?>			<div id="menu">			<div id="navigationMap">				<ul><li><a class="typ" href="accueil.php"><img src="images/RoB_Home.png" /></a></li><li><a class="typ" href="collaborateurs.php"><span>G&eacute;rer les collaborateurs</span></a></li><li><a class="typ" href="#"><span>Profiles</span></a></li></ul>			</div>			<table id="tablerestit" class="table table-striped temp-table">				<tr>					<td id="t-containertit">Menus</td>					<?php					//Définition des colonnes selon les niveaux de profils					if ($_SESSION['id_lev_menu'] == 10)					{						$req = "SELECT code FROM rob_level WHERE ID <= ".$_SESSION['id_lev_menu'];					}					else					{						if ($_SESSION['id_lev_menu'] == 6)						{							$req = "SELECT code FROM rob_level WHERE actif = 1 AND ID <= ".$_SESSION['id_lev_menu'];						}						else						{							$req = "SELECT code FROM rob_level WHERE actif = 1 AND ID < ".$_SESSION['id_lev_menu'];						}					}					$reponse = $bdd->query($req );					$checkrep = $reponse->rowCount();					$col=1;					while ($donnee = $reponse->fetch() )					{						echo '<td id="t-containertit" align="center" width="90px">'.$donnee[0].'</td>';						$col = $col + 1;					}					$reponse->closeCursor();					?>				</tr>								<?php				//Selection des groupements de menus				if ($_SESSION['id_lev_menu'] == 10)				{					$men= "SELECT * FROM rob_menus ORDER BY code";				}				else				{					$men= "SELECT * FROM rob_menus WHERE actif=1 ORDER BY code";				}				$menu = $bdd->query($men);				while ($donmen = $menu->fetch())				{					//titre du menu en cours de lecture					$curr_menu_id = $donmen['ID'];					$curr_menu_desc = $donmen['desc1'];					if($donmen['actif'] == 1) { $curr_menu_actif='actif'; } else { $curr_menu_actif='inactif'; }					echo '<tr><td id="t-containertit" colspan="'.$col.'"><br/>'.$curr_menu_desc.' ('.$curr_menu_actif.')</td></tr>';					//Pour chaque menu, on récupère les sous-menu y afférent					if ($_SESSION['id_lev_menu'] == 10)					{						$reqs = "SELECT * FROM rob_ssmenu WHERE menu_id = ".$curr_menu_id;					}					else					{						$reqs = "SELECT * FROM rob_ssmenu WHERE actif = 1 AND menu_id = ".$curr_menu_id;					}					$reponses = $bdd->query($reqs);					$i=1;					while ($donnees = $reponses->fetch() )					{						//Pour chaque menu, on boucle sur le sous-menu						$curr_ssmenu_id = $donnees['ID'];						$curr_ssmenu_desc = $donnees['desc1'];						if($donnees['actif'] == 1) { $curr_ssmenu_actif='actif'; } else { $curr_ssmenu_actif='inactif'; }						echo '<tr><td id="t-container'.$i.'" >'.$curr_ssmenu_desc.' ('.$curr_ssmenu_actif.')</td>';						if ($_SESSION['id_lev_menu'] == 10)						{							$reqr = "SELECT ID FROM rob_level WHERE ID <= ".$_SESSION['id_lev_menu'];						}						else						{							if ($_SESSION['id_lev_menu'] == 6)							{								$reqr = "SELECT ID FROM rob_level WHERE actif = 1 AND ID <= ".$_SESSION['id_lev_menu'];							}							else							{								$reqr = "SELECT ID FROM rob_level WHERE actif = 1 AND ID < ".$_SESSION['id_lev_menu'];							}						}						$reponser = $bdd->query($reqr);						while ($donneer = $reponser->fetch() )						{							$curr_level_id = $donneer['ID'];							$req= "SELECT * FROM rob_menu_rights WHERE menu_id = ".$curr_menu_id." AND ssmenu_id = ".$curr_ssmenu_id." AND (level = -1 OR level = ".$curr_level_id.")";							$reponse = $bdd->query($req);							$checkrep = $reponse->rowCount();							echo '<td id="t-container'.$i.'" align="center"><form action="profile.php" method="post">';							echo '<input type="hidden" value="'.$curr_menu_id.'" name="curr_menu_id" />';							echo '<input type="hidden" value="'.$curr_ssmenu_id.'" name="curr_ssmenu_id" />';							echo '<input type="hidden" value="'.$curr_level_id.'" name="curr_level_id" />';							if ($checkrep != 0)							{								$don = $reponse->fetch();								$supprid = $don['ID'];								echo '<input type="hidden" value="'.$supprid.'" name="Suppr" />';								echo '<input border=0 src="images/RoB_Activ.png" type=image Value=submit title="supprimer les droits" >';							}							else							{								echo '<input type="hidden" value="1" name="Add" />';								echo '<input border=0 src="images/RoB_Deactiv.png" type=image Value=submit title="Ajouter les droits" >';							}							echo '</form></td>';							$reponse->closeCursor();						}						$reponser->closeCursor();						echo '</tr>';						if ($i == 1) { $i = 2; } else { $i = 1; }					}					$reponses->closeCursor();				}				$menu->closeCursor();				?>			</table>			<form action="collaborateurs.php" method="post">				<div id="f-valider"><?php echo '<input id="w_input_90val" type="submit" Value="Retour" name="Retour" />'; ?></div>			</form>		</div>		<?php	include("footer.php");}else{	header("location:index.php");}?>